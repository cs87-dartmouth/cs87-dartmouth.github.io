<meta charset="utf-8"><!-- -*- markdown -*- -->
<style class="fallback">body{visibility:hidden}</style>

**Assignment 0: DIRT Preliminaries**

In this class, you will be using C++ to write a ray tracer largely from scratch. To help you get off the ground, however, we provide you with some base code: The Dartmouth Introductory Ray Tracer, or _DIRT._

DIRT is a minimalistic skeleton for a ray tracer, written in C++. It runs on Windows, Linux, and MacOS and will provide the foundation for the programming assignments we'll be doing in this class. While DIRT cannot (yet) produce images, it provides many features that would be tedious to implement from scratch, including:

*   A JSON-based scene file loader
*   A nice command-line interface with option parsing, colorful text output, and a text-based progress bar for long operations
*   Basic color/vector/matrix/ray/bounding box classes
*   A pseudorandom number generator ([PCG32](http://www.pcg-random.org/))
*   Support for loading and saving images in a variety of formats
*   A loader for Wavefront OBJ files
*   A basic acceleration structure that will let you ray trace scenes with many primitives reasonably quickly

In the first few assignments, you will fill in empty methods left in the base code, and test them using the tools provided with each assignment. In latter assignments, you will need to figure out what functions and classes you will need to add to the code to accomplish the tasks.

In this assignment, you will learn the basics of how to setup your programming environment, how to get the Dirt base code, and how to submit your solutions. The deadline for this assignment is **September 18th.** This assignment is not difficult to do, and its only intention is to make sure you have a working development environment.

# Tasks

By the end of this assignment, you will have

*   Cloned the base code git repository
*   Setup your programming environment and successfully compiled the basecode
*   Completed both parts of the programming assignment, explained below

# Permissible sources of information

Beyond lecture material, we will rely on two different books for this class.

Firstly, we will be using Peter Shirley's excellent and very accessible "In One Weekend" series of mini e-books. These "books" are short, fun and informal – more like blog posts than textbooks – and are a great way to get started on this exciting topic. Peter Shirley walks through the implementation of a fully operational, though simple, ray tracer. You can and should read through these books and the contained implementation. However, the full source of the ray tracer described in the book is now also available online. I ask that you _**not**_ read/copy-paste the source code directly, but instead read the books. I am a firm believer that you should actually go through the process of writing the code yourself. Beyond the obvious academic integrity issues, you are also unlikely to learn much by copy-pasting. Furthermore, since we build off of DIRT in this class, the code bases and design decisions will deviate from those in the books, so you will ultimately need to write your own code to complete the assignments.

On the other end of the spectrum, we will be also be using "_Physically Based Rendering, Third Edition: From Theory To Implementation_" by Matt Pharr, Wenzel Jakob, and Greg Humphreys. This is a big (sometimes intimidating) textbook, with all the mathematical details you will need to dive deep into a rendering topic. We will use this as a reference to complement the Shirley mini-books and lecture. 

The first few assignments will largely mirror the concepts in Shirley's three mini books, but as the quarter progresses, we will introduce more and more concepts from the Pharr et al. book. Our hope is that this combination will get you started making images quickly, but by building off the DIRT basecode, and following the design suggestions we incorporate from PBR, you will end up with a much more general and full-featured render than the one in Shirley's books alone.

You are also welcome to consult additional references when completing projects, but remember to cite them in your writeup. Remember, when asked to implement feature X, we request that you don't go and read the source code of the implementation of X in some other renderer, because you will likely not learn much in the process. The official course textbooks are excluded from this rule. If in doubt, get in touch with the course staff.

# Obtaining the base code

The base code for this class is provided as a _git repository_. git is a version control system that allows you to keep track of changes in your code over time, collaborate with other people, track down bugs and more. git is the most widely used version control system today, and this is a good opportunity to learn it if you haven't already.

In this class, you will use git to obtain new and updated versions of the base code. During assignments, you will edit your own local copy of the base code. If we hand out new assignments or add improvements to the base code, git allows you to obtain the updated code and merge it with your local copy without losing your changes.

git is a versatile tool and allows you to achieve more than just obtaining new code from us. If you want to know more, a few external resources we can recommend are [try git](https://try.github.io/levels/1/challenges/1), [git-the simple guide ](http://rogerdudler.github.io/git-guide/), the [git immersion tutorial ](http://gitimmersion.com/index.html), and the extensive free [Pro Git ](http://git-scm.com/book/en/v2)ebook.

Before proceeding to the rest of this section, you need to install git. Please see the [first chapter](https://git-scm.com/book/en/v2/Getting-Started-Installing-Git) of the git book to find installation instructions for your system.

## Cloning the repository

The base code for this class is available on the [departmental gitlab server](https://gitlab.cs.dartmouth.edu/). If you do not already have an account, you will need to create one using either your @dartmouth.edu or @cs.dartmouth.edu email address. If you have trouble accessing the code, please contact the TA.

### Cloning using the command line

If you are familiar with using the command line on your system, you can easily obtain the base code that way. Navigate to the directory you want to download the base code to, then enter the command

~~~ bash
git clone https://gitlab.cs.dartmouth.edu/cs87-fa19/dirt_basecode.git
~~~

### Cloning using a GUI tool.

On Windows and macOS, [GitHub Desktop](https://desktop.github.com/) is a convenient visual front-end to Git. We particularly recommend this tool if you've never used Git before. After proceeding through the installation,  use Add/Clone repository/URL to add the base code repository for this class.

An alternative to GitHub Desktop is [Source Tree](http://www.sourcetreeapp.com/).

# Setting up a C++ compiler and building the base code

We recommend you edit the code using [VS Code](https://code.visualstudio.com/), which is a free and powerful code editor that works on Windows, Linux, and macOS. The rest of this guide will assume you're using VS Code.

Make sure that VS Code is extracted into a directory that is writable, for example your home directory; otherwise, you won't be able to install plugins (VS Code will warn you when this happens).

You will also need to do some platform specific setup steps to get code compiled:

(##) macOS

To compile C++ on macOS, you will need to install [XCode](https://developer.apple.com/xcode/), which contains compilers and developer tools provided by Apple. If you don't have XCode installed already, you can find and download it from the app store.

You may need to install CMake too, if the VS Code plugin asks you for it. You can get it [from the CMake website](https://cmake.org/download/) (get the *.dmg installer).

(##) Windows / Visual Studio Community

To compile things on Windows, you will need to install a version of Visual Studio. We recommend [Visual Studio Community](https://visualstudio.microsoft.com/vs/community/) and a reasonably recent version of  [CMake ](http://www.cmake.org/download/).

(##) Linux

If you're using linux, you most likely already know what to do - just install a C++ compiler (gcc or clang), and cmake using your package manager.

## Setting up VS Code

Once you have followed the steps above and have installed the build tools for your operating system, you can go ahead and configure VS Code to compile your code.

First, launch VS Code and go to the plugins tab:

![plugins.png](https://canvas.dartmouth.edu/courses/48965/files/8415679/preview)

Then, install **C++** and **CMake** tools:

![c++-plugin.png](https://canvas.dartmouth.edu/courses/48965/files/8415683/preview)

VS Code will ask you to reload to finish installing the plugins. Do that.

Then, go to File->Open and open the `dirt_basecode` folder:

![open-dialog.png](https://canvas.dartmouth.edu/courses/48965/files/8415677/preview)

This will bring all source files into your editor. On the left, you can explore the file system and open the individual source files.

CMake will now ask you to configure your project. Do that:

![configure.png](https://canvas.dartmouth.edu/courses/48965/files/8415678/preview)

Depending on your platform, it will ask you to select a "kit" - in other words, it wants to know what compiler you would like to use. Click "Scan for Kits". This brings up a small dialog at the top of your screen:

![kit-selection.png](https://canvas.dartmouth.edu/courses/48965/files/8415681/preview)

The contents of this dialog depend on your platform. For macOS, you would want to select Clang; for Linux, you want GCC, and for Windows, you want Visual Studio amd64.

Navigate to your CMake tab (the big triangle on the left) and first configure your project (click on the small triangle) and then build your project (click on the hammer):

![build-dialog.png](https://canvas.dartmouth.edu/courses/48965/files/8415680/preview)

Congratulations! If everything has gone well, you have just built the basecode for this assignment.

You can see the output of the build process at the bottom of the screen (in the "output" tab). Things should compile fine; if not, and you think this is a problem with the basecode, contact us immediately or come to office hours.

## Running the executable

If the previous part has gone well, you have built an executable you can run on your machine.

On the bottom of your screen, there is a "Terminal" tab. Open it, and type in the path to `build/00_dirt_tutorial`. This will run the program you just compiled. If all goes well, you should see output like this:

![run-output.png](https://canvas.dartmouth.edu/courses/48965/files/8415653/preview)

## Documentation

Large parts of dirt are documented using [doxygen](http://www.doxygen.nl/), which is an automatic tool for generating HTML documentation from source code. For convenience, we've included a precompiled version of the documentation in the basecode; simply open `documentation/index.html` in a browser.

## Wrapping Up

If all has gone well, you are now ready to edit, compile and run your code.

You can start editing now – whenever you're satisfied with your changes, head over to the CMake tab and build your program (hit the hammer), and run it using the terminal (this is the C++ equivalent of hitting F5 in your browser).

You can build your code in _Debug_ mode or _Release_ mode. Debug mode adds more debugging information to your code (for when you want to troubleshoot problems), but it is much, much slower than Release mode (with a ray tracer, it is not uncommon for Debug to be 10 to 100X slower than Release). Your code will build in debug mode by default. You can switch to Release mode by clicking Debug in the bottom of the window:

![build-mode.png](https://canvas.dartmouth.edu/courses/48965/files/8415684/preview)

This will open a dialog at the top of the window. Click on Release if you want a fast program:

![mode-selection.png](https://canvas.dartmouth.edu/courses/48965/files/8415760/preview)

# A high-level overview of DIRT

The dirt repository consists of the base code files (first table) and several dependency libraries (second table) that we briefly explain below.

Directory                | Description
-------------------------|------------
`src/`                   | A directory containing the main C++ source code
`include/dirt`           | A directory containing header files with declarations
`CMakeLists.txt`         | A CMake build file which specifies how to compile and link Dirt
`scenes/`                | Example scenes and test datasets to validate your implementation
`ext/`                   | External dependency libraries (see the second table)
`ext/CMakeLists.txt`     | A low-level CMake build file which specifies how to compile and link Dirt and its several dependency libraries. You probably won't have to change anything here.


Directory                | Description
-------------------------|------------
`ext/pcg32`	             | A tiny self-contained pseudorandom number generator
`ext/filesystem`	     | A tiny self-contained library for manipulating paths on various platforms
`ext/json`	             | A JSON parsing library for C++
`ext/tinyformat`	     | Type-safe C++11 version of printf and sprintf
`ext/stb_image`	         | For loading and saving images

# Programming Assignment

For the programming part of this assignment, you will need to familiarize yourself with the basecode that we provide and implement a few tiny changes to make things work.

Go ahead and open up `src/00_dirt_tutorial.cpp`. This is the file you will be editing for this assignment.

Don't be overwhelmed by the size of this file - the majority of it is comments and functionality provided by us to test your code.

## Part 1: Vectors

For the first part of the programming assignment you need to learn how to use vectors and matrices in DIRT. Head over to `void testVectorsAndMatrices()` and read the comments to get started. Everything that you need to change has been marked with a `TODO` comment.

## Part 2: Colors and Images

Head on over to `void testColorAndImage()` and read through the instructions. Everything that you need to change has been marked with a _TODO_ comment.

You will generate and write a `gradient.png` image, that should look something like this:

![gradient.png](https://canvas.dartmouth.edu/courses/48965/files/8415759/preview)

To complete the last part of the function, you should load the image in `scenes/00_preliminaries/cornellbox.png` that comes with the base code, convert it to grayscale (as described in the code) and save it under `scenes/00_preliminaries/__cornell_grayscale.png`. The input image is shown below on the left; the expected output is shown on the right.

<div class="twentytwenty-container">
    <img src="https://canvas.dartmouth.edu/courses/48965/files/8415761/preview" alt="Reference">
    <img src="https://canvas.dartmouth.edu/courses/48965/files/8415762/preview" alt="Mine">
</div>

## What to submit

**Please read the following instructions carefully: Include the required files and nothing else. Do not pack the required files into a containing folder, just zip the files directly.**

Please edit the `report/report.html` report template and fill in your feedback, comments and optional explanations. Add a section for each task. If a task provides a reference image, please include a comparison between the image produced by your code and the reference (the template shows you how to do this easily).

Upload a zip file containing

* The source code (the entire `include` and `src` folders)
* An `output.txt` file that contains the output of the `00_dirt_tutorial` program. You can create this by running
  ~~~bash
  $ build/00_dirt_tutorial > output.txt
  ~~~
  on the command line from your `dirt_basecode` root directory.

* The `report` folder.

**Do not submit any binaries. Do not include your build folder in the zip file. Do not put the required files/folders into a containing folder; zip them directly and submit the zip file.**

<script>
markdeepOptions = {tocStyle: 'medium'};
</script>


<script src="../js/common.js"></script>